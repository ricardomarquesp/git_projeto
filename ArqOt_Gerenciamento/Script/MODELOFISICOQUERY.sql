USE CHARCUTARIA2

create table FORNECEDOR(
cod_fornecedor int primary key not null,
nome_fornecedor varchar (50) not null)
ALTER TABLE PRODUTO ADD CONSTRAINT fornecedor_id_fk
FOREIGN KEY (cod_fornecedor) REFERENCES FORNECEDOR (cod_fornecedor)


create table CATEGORIA(
cod_categoria int primary key not null,
nome_categoria varchar (20) not null)

ALTER TABLE PRODUTO ADD CONSTRAINT categoria_id_fk
FOREIGN KEY (cod_categoria) REFERENCES CATEGORIA (cod_categoria)

create table PRODUTO(
cod_produto int primary key not null,
cod_categoria int not null,
cod_fornecedor int not null,
nome_produto varchar (50) not null,
qtd_produto int not null,
valor_produto decimal(10,2))

ALTER TABLE PRODUTO_PEDIDO ADD CONSTRAINT produto_cod_fk
FOREIGN KEY (cod_produto) REFERENCES PRODUTO (cod_produto)

create table PRODUTO_PEDIDO(
n_fiscal int primary key not null,
cod_produto int not null,
cod_pedido int not null,
qtd_pedi int not null,
valor_pedido decimal(10,2))

create table PEDIDO(
cod_pedido int primary key not null,
cod_trans int not null,
cod_cliente int not null,
qtd_pedido int not null,
valor_pedido decimal(10,2),
data_pedido date)

ALTER TABLE PRODUTO_PEDIDO ADD CONSTRAINT pedido_cod_fk
FOREIGN KEY (cod_pedido) REFERENCES PEDIDO (cod_pedido)

create table TRANSPORTADORA(
cod_trans int primary key not null,
nome_transportadora varchar (30) not null)
select * from TRANSPORTADORA

ALTER TABLE PEDIDO ADD CONSTRAINT trans_cod_fk
FOREIGN KEY (cod_trans) REFERENCES TRANSPORTADORA (cod_trans)


create table CLIENTE(
cod_cliente int primary key not null,
nome_cliente varchar (30) not null,
sobrenome_cliente varchar (50) not null,
sexo_cliente varchar (15) not null,
data_nascimento date not null)

ALTER TABLE PEDIDO ADD CONSTRAINT cliente_cod_fk
FOREIGN KEY (cod_cliente) REFERENCES CLIENTE (cod_cliente)

SELECT TOP 100 * FROM CLIENTE
INSERT INTO CLIENTE  VALUES (099871,'PEDRO', 'ANDRADE','MASCULINO','12/02/1984')
INSERT INTO CLIENTE  VALUES (099872,'JOAO', 'FERREIRA','MASCULINO','05/02/1988')
INSERT INTO CLIENTE  VALUES (099873,'ROBERTO', 'URSO','MASCULINO','12/04/1990')
INSERT INTO CLIENTE  VALUES (099874,'FERNANDO', 'SOARES DA SILVA','MASCULINO','07/03/1975')
INSERT INTO CLIENTE  VALUES (099875,'GUSTAVO', 'ABREU','MASCULINO','25/08/1995')
INSERT INTO CLIENTE  VALUES (099876,'ARTHUR', 'MENDES FERREIRA','MASCULINO','06/10/1984')
INSERT INTO CLIENTE  VALUES (099877,'MARIA RITA', 'ANDRADE','FEMININO','12/02/1984')
INSERT INTO CLIENTE  VALUES (099878,'CLAUDIA', 'ANTUNES','FEMININO','12/02/1984')
INSERT INTO CLIENTE  VALUES (099879,'FERNANDA', 'VENTURA','FEMININO','10/02/1984')
INSERT INTO CLIENTE  VALUES (099883,'LAURA', 'GARCIA','FEMININO','06/06/1984')
INSERT INTO CLIENTE  VALUES (099880,'TAMIRES', 'NEVES','FEMININO','14/04/1995')
INSERT INTO CLIENTE  VALUES (099881,'TEREZA', 'DE PAULA','FEMININO','16/02/1995')
INSERT INTO CLIENTE  VALUES (099882,'ELISA', 'ALVES','FEMININO','03/01/1999')
INSERT INTO CLIENTE  VALUES (099884,'DALISE', 'ALVES CUNHA','FEMININO','03/01/1979')
ALTER TABLE PEDIDO ADD CONSTRAINT cliente_cod_fk
FOREIGN KEY (cod_cliente) REFERENCES CLIENTE (cod_cliente)

select *from CATEGORIA
DELETE from CATEGORIA
WHERE cod_categoria = 083

/*INSERT CATEGORIA */
INSERT INTO CATEGORIA  VALUES (0200,'SUINO')
INSERT INTO CATEGORIA  VALUES (0201,'BOVINO')


/*INSERT FORNECEDOR */
INSERT INTO FORNECEDOR  VALUES (081,'FRIGOMAIS')
INSERT INTO FORNECEDOR  VALUES (082,'BOVINOSKING')
INSERT INTO FORNECEDOR  VALUES (083,'FRIGORIFICO SANTANA')

SELECT * FROM CLIENTE
DELETE from PRODUTO
WHERE cod_produto = 103

/*INSERT PRODUTO */

INSERT INTO PRODUTO  VALUES (100,0201,082,'PICANHA KG',20,59.00)
INSERT INTO PRODUTO  VALUES (101,0201,082,'PATINHO KG',20,29.00)
INSERT INTO PRODUTO  VALUES (102,0201,082,'CARNE MOIDA KG',40,25.00)
INSERT INTO PRODUTO  VALUES (103,0201,082,'ACEM KG',20,16.00)
INSERT INTO PRODUTO  VALUES (91,0200,081,'PALETA KG',10,20.00)
INSERT INTO PRODUTO  VALUES (92,0200,081,'PANCETA KG',10,25.00)
INSERT INTO PRODUTO  VALUES (93,0200,081,'COSTELA SUINA KG',15,32.00)
INSERT INTO PRODUTO  VALUES (95,0200,083,'COPA LOMBO KG',10,15.00)
INSERT INTO PRODUTO  VALUES (96,0200,083,'LOMBO KG',20,22.00)
INSERT INTO PRODUTO  VALUES (97,0200,083,'Linguiça PURA KG',20,20.00)
INSERT INTO PRODUTO  VALUES (98,0200,083,'Linguiça Defumada',30,20.00)


INSERT INTO TRANSPORTADORA  VALUES (02221,'JATO TRANSPORTES')
INSERT INTO TRANSPORTADORA  VALUES (02222,'OMNI TRANSPORTES')

SELECT * FROM TRANSPORTADORA

SET STATISTICS IO ON
SET STATISTICS PROFILE ON
  SELECT c.cod_categoria, c.nome_categoria
  FROM CATEGORIA  c
  JOIN PRODUTO p ON c.cod_categoria = p.cod_categoria
  WHERE p.cod_produto >= 098 and  p.cod_produto < 102

  SELECT p.cod_cliente, p.cod_pedido, p.qtd_pedido,p.valor_pedido, c.nome_cliente
  FROM PEDIDO p
  JOIN CLIENTE c ON c.cod_cliente = p.cod_cliente
  WHERE c.sexo_cliente = 'MASCULINO'

  SELECT * FROM PRODUTO


  INSERT INTO PRODUTO_PEDIDO VALUES(456780,100,725,4,236.00)
INSERT INTO PRODUTO_PEDIDO VALUES(456781,100,726,2,118.00)
INSERT INTO PRODUTO_PEDIDO VALUES(456782,95,727,3,45.00)
INSERT INTO PRODUTO_PEDIDO VALUES(456783,96,728,5,110.00)
INSERT INTO PRODUTO_PEDIDO VALUES(456784,97,729,6,120.00)
INSERT INTO PRODUTO_PEDIDO VALUES(456785,103,730,2,64.00)
INSERT INTO PRODUTO_PEDIDO VALUES(456786,102,731,1,25.00)
INSERT INTO PRODUTO_PEDIDO VALUES(456787,92,732,1,25.00)
INSERT INTO PRODUTO_PEDIDO VALUES(456788,100,733,2,118.00)
INSERT INTO PRODUTO_PEDIDO VALUES(456789,91,734,3,60.00)
INSERT INTO PRODUTO_PEDIDO VALUES(456790,92,735,3,75.00)

SELECT * FROM PEDIDO
SELECT * FROM PRODUTO_PEDIDO
SELECT * FROM PRODUTO
SELECT * FROM CLIENTE
SELECT * FROM TRANSPORTADORA
SELECT * FROM FORNECEDOR
SELECT * FROM CATEGORIA

INSERT INTO PEDIDO  VALUES (725,2221,99873,4,236.00,'10/11/2021')
INSERT INTO PEDIDO  VALUES(726,2221,99883,2,118.00,'12/11/2021')
INSERT INTO PEDIDO  VALUES(727,2222,99881,3,45.00,'12/11/2021')
INSERT INTO PEDIDO  VALUES(728,2222,99871,5,110.00,'15/11/2021')
INSERT INTO PEDIDO  VALUES(729,2222,99876,6,120.00,'16/11/2021')
INSERT INTO PEDIDO  VALUES(730,2221,99875,2,64.00,'20/11/2021')
INSERT INTO PEDIDO  VALUES(731,2221,99872,1,25.00,'20/11/2021')
INSERT INTO PEDIDO  VALUES(732,2222,99877,1,25.00,'20/11/2021')
INSERT INTO PEDIDO  VALUES(733,2221,99884,2,118.00,'01/11/2021')
INSERT INTO PEDIDO  VALUES(734,2222,99882,3,60.00,'02/11/2021')
INSERT INTO PEDIDO  VALUES(735,2222,99874,3,75.00,'07/11/2021')


select *from CATEGORIA
DELETE from CATEGORIA
WHERE cod_categoria = 083

create index IX_produto_VALOR on PRODUTO(valor_produto)
include (cod_produto,qtd_produto,nome_produto)

DROP INDEX IX_produto_nome 
    ON PRODUTO 
GO  

SELECT cod_produto,qtd_produto,nome_produto,valor_produto
  FROM PRODUTO
  WHERE valor_produto = 20.00 AND qtd_produto >= 15
  ORDER BY cod_produto

  set statistics io on